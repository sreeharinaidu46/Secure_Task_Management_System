<div class="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-8">
  <div class="max-w-5xl mx-auto">
    <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">
      My Tasks
    </h1>

    <!-- üîç Search + Add + Logout -->
    <div class="flex justify-between items-center mb-6 flex-wrap gap-4">
      <div class="flex gap-3 w-full md:w-auto">
        <input
          [(ngModel)]="searchTerm"
          (input)="applyFilter()"
          placeholder="Search tasks..."
          class="border px-3 py-2 rounded-lg w-full md:w-64"
        />
      </div>

      <div class="flex gap-3">
        <button
          (click)="showForm = !showForm"
          class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-all"
        >
          {{ showForm ? 'Cancel' : '‚ûï Add Task' }}
        </button>

        <button
          (click)="logout()"
          class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-all"
        >
          üö™ Logout
        </button>
      </div>
    </div>

    <!-- ‚ûï Add Form -->
    <form
      *ngIf="showForm"
      (ngSubmit)="saveTask()
      "
      class="bg-white p-4 rounded-xl shadow mb-6 grid grid-cols-1 md:grid-cols-4 gap-4"
    >
      <input
        [(ngModel)]="newTask.title"
        name="title"
        placeholder="Task title"
        required
        class="border px-3 py-2 rounded-lg md:col-span-4"
      />

      <textarea
        [(ngModel)]="newTask.description"
        name="description"
        placeholder="Task description"
        rows="3"
        class="border px-3 py-2 rounded-lg md:col-span-4"
      ></textarea>

      <!-- Type -->
      <select
        [(ngModel)]="newTask.type"
        name="type"
        class="border px-3 py-2 rounded-lg"
      >
        <option>Work</option>
        <option>Personal</option>
      </select>

      <!-- Status -->
      <select
        [(ngModel)]="newTask.status"
        name="status"
        class="border px-3 py-2 rounded-lg"
      >
        <option>Todo</option>
        <option>In-Progress</option>
        <option>In-Test</option>
        <option>Done</option>
      </select>

      <div class="md:col-span-2 flex justify-end">
        <button
          type="submit"
          class="bg-green-600 text-white rounded-lg px-4 py-2 hover:bg-green-700"
        >
          Save
        </button>
      </div>
    </form>

    <!-- üìã Task List -->
    <div
      cdkDropList
      (cdkDropListDropped)="drop($event)"
      class="bg-white rounded-xl shadow divide-y divide-gray-100"
    >
      <div
        *ngFor="let task of filteredTasks"
        cdkDrag
        class="p-4 flex justify-between items-center hover:bg-gray-50"
      >
        <div class="space-y-1">
          <h3 class="font-semibold text-gray-800">{{ task.title }}</h3>
          <p class="text-sm text-gray-500 italic">
            {{ task.description || 'No description' }}
          </p>

          <div class="flex gap-2">
            <!-- Type badge -->
            <span
              class="text-xs text-white px-2 py-1 rounded"
              [ngClass]="{
                'bg-blue-500': task.type === 'Work',
                'bg-green-500': task.type === 'Personal'
              }"
            >
              {{ task.type }}
            </span>

            <!-- Status badge -->
            <span
              class="text-xs text-white px-2 py-1 rounded"
              [ngClass]="{
                'bg-gray-500': task.status === 'Todo',
                'bg-amber-500': task.status === 'In-Progress',
                'bg-purple-500': task.status === 'In-Test',
                'bg-emerald-600': task.status === 'Done'
              }"
            >
              {{ task.status }}
            </span>
          </div>
        </div>

        <div class="flex gap-2">
          <button
            (click)="editTask(task)"
            class="text-indigo-500 hover:text-indigo-700 text-sm"
          >
            ‚úèÔ∏è Edit
          </button>
          <button
            (click)="deleteTask(task.id)"
            class="text-red-500 hover:text-red-700 text-sm"
          >
            ‚úñ Delete
          </button>
        </div>
      </div>
    </div>

    <!-- ‚úèÔ∏è Edit Modal -->
    <div
      *ngIf="editingTask"
      class="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50"
    >
      <div class="bg-white p-6 rounded-xl w-96 shadow-xl">
        <h2 class="text-lg font-bold mb-4">Edit Task</h2>
        <form (ngSubmit)="updateTask()">
          <input
            [(ngModel)]="editingTask.title"
            name="title"
            class="border px-3 py-2 rounded-lg w-full mb-3"
          />
          <textarea
            [(ngModel)]="editingTask.description"
            name="description"
            class="border px-3 py-2 rounded-lg w-full mb-3"
          ></textarea>

          <select
            [(ngModel)]="editingTask.type"
            name="type"
            class="border px-3 py-2 rounded-lg w-full mb-3"
          >
            <option>Work</option>
            <option>Personal</option>
          </select>

          <!-- Status (edit) -->
          <select
            [(ngModel)]="editingTask.status"
            name="status"
            class="border px-3 py-2 rounded-lg w-full mb-4"
          >
            <option>Todo</option>
            <option>In-Progress</option>
            <option>In-Test</option>
            <option>Done</option>
          </select>

          <div class="flex justify-end gap-2">
            <button
              type="button"
              (click)="cancelEdit()"
              class="bg-gray-300 px-4 py-2 rounded-lg"
            >
              Cancel
            </button>
            <button
              type="submit"
              class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"
            >
              Update
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
